<!DOCTYPE html>
    <head>
        <title>Deep Learning</title>
        <link rel="stylesheet" media="screen" href ="static/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>   
        <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.css" rel="stylesheet"/>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    </head>
    
    <body>
        <style>
            /* label 和 select 之間的間隔 */
            form label {
                width: 20%;
            }
            .flex-container {
                    display: flex;
                }
    
            .flex-container > div {          
                color: black;          
            }
            a.list-group-item{
                font-size: 24px;
            }
            input {
                float:left;
            }
            .badge {
                margin:3px;    
            }
        </style>
        {% include '_navbar.html' %}
        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-1">
            {% if error %}
            <div class="alert alert-danger">
            <strong>Error:</strong> {{ error }}
            </div>
            {% endif %}
            <div class="flex-container">
                <!-- <div class="k-content k-grid__item k-grid__item--fluid k-grid k-grid--hor" id="k_content"> -->
                    <div class="k-portlet k-portlet--tabs">
                        <div class="k-portlet__head k-portlet__head--lg k-portlet__head--noborder k-portlet__head--break-sm">
                            <div class="k-portlet__head-label">
                                <h3 class="k-portlet__head-title">Records</h3>
                            </div>
                            <div class="k-portlet__head-toolbar">
                                <div class="k-portlet__head-wrapper k-form">
                                    <div class="k-form__group k-form__group--inline k-margin-r-10"></div>      <!-- 間隔 -->                                  
                                    <form method="post">
                                        <button type="submit" class="btn btn-success btn btn-brand btn-upper btn-bold" name="btn">Create</button>
                                    </form>
                                    <div class="k-form__group k-form__group--inline k-margin-r-10"></div>
                                    <input type="button" class="btn btn-danger btn btn-brand btn-upper btn-bold" id="delBtn" value="Del" name="delBtn" onclick="del_port()">
                                </div>
                            </div>
                        </div>

                        <div class="k-portlet__body">
                            <!--begin::Portlet-->                                    
                            <div class="k-datatable k-datatable--default k-datatable--brand k-datatable--loaded k-datatable--scroll" id="k_recent_orders">
                                <table id="aaaaaa" class="k-datatable__table" style="display: block; min-height: 100px; max-height: 430px; ">
                                    <thead class="k-datatable__head">
                                        <tr class="k-datatable__row" style="left: 5px;">
                                            <th style="width: 20px" class="k-datatable__cell--center k-datatable__cell k-datatable__cell--check">
                                                <span>
                                                    <label class="k-checkbox k-checkbox--single k-checkbox--solid k-checkbox--brand">
                                                        <input id="all" type="checkbox" onclick="select_all()">&nbsp;
                                                    <span></span>
                                                    </label>
                                                </span>
                                            </th>
                                            <th style="width: 20%;" data-field="name" class="k-datatable__cell">
                                                <span >Dataset Name</span>
                                            </th>
                                            <th style="width: 80%;" data-field="time" class="k-datatable__cell">
                                                <span >Class</span>
                                            </th>                                  
                                        </tr>
                                    </thead>
                                    
                                    <tbody style="max-height: 375.5px;" class="k-datatable__body ps ps--active-y">
                                        
                                        {%- for item in tree recursive %}                                       
                                        <tr class="k-datatable__row" style="left: 0px;">
                                            <td style="width: 20px;" class="k-datatable__cell--center k-datatable__cell k-datatable__cell--check">                                               
                                                    <label class="k-checkbox k-checkbox--single k-checkbox--solid k-checkbox--brand">
                                                        <input id="{{ item.ID }}" type="checkbox" value="{{ item.RunTime }}">&nbsp;
                                                <span></span>
                                                </label>                                               
                                            </td>                                            
                                            <td style="width: 20%;" class="k-datatable__cell k-datatable__cell--sort" onclick="select_click({{ item.ID }})">
                                                <span class="k-label-font-color-3 k-font-bold">{{ item.Name }}</span>
                                            </td>
                                            <td style="width: 80%;" class="k-datatable__cell k-datatable__cell--sort" onclick="select_click({{ item.ID }})">
                                                    <span class="k-label-font-color-3 k-font-bold">{{ item.Class }}</span>
                                            </td>                                         
                                        </tr>
                                        {%- endfor %}                                       
                                    </tbody>
                                </table>
                                  <!-- <div class="k-datatable__pager k-datatable--paging-loaded clearfix">
                                    <ul class="k-datatable__pager-nav">
                                        <li>
                                            <a title="First" class="k-datatable__pager-link k-datatable__pager-link--first k-datatable__pager-link--disabled" data-page="1" disabled="disabled">
                                                <i class="la la-angle-double-left"></i>
                                            </a>
                                        </li>
                                        <li>
                                            <a title="Previous" class="k-datatable__pager-link k-datatable__pager-link--prev k-datatable__pager-link--disabled" data-page="1" disabled="disabled">
                                                <i class="la la-angle-left"></i>
                                            </a>
                                        </li>
                                        <li style="display: none;">
                                            <a title="More pages" class="k-datatable__pager-link k-datatable__pager-link--more-prev" data-page="1">
                                                <i class="la la-ellipsis-h"></i>
                                            </a>
                                        </li>
                                        <li style="display: none;"><input type="text" class="k-pager-input form-control" title="Page number"></li>
                                        <li>
                                            <a class="k-datatable__pager-link k-datatable__pager-link-number k-datatable__pager-link--active" data-page="1" title="1">1</a>
                                        </li>
                                        <li>
                                            <a class="k-datatable__pager-link k-datatable__pager-link-number" data-page="2" title="2">2</a>
                                        </li>
                                        <li>
                                            <a title="Last" class="k-datatable__pager-link k-datatable__pager-link--last" data-page="100">
                                                <i class="la la-angle-double-right"></i>
                                            </a>
                                        </li>
                                    </ul>
                                 
                                </div> -->
                            </div>                              
                        </div>
                    </div>
                </div>
            </div>
          
        </main>
        <style>
            h2{
                margin: 5px;
            }
            td span{
                text-align: left;
            }
        </style>
        <script>
            function select_all(){
                var len = {{tree|length}};
                if (document.getElementById("all").checked) {
                    for(i =1; i < len+1; i++){
                        document.getElementById(i).checked = true;
                    }
                }else{
                    for(i =1; i < len+1; i++){
                        document.getElementById(i).checked = false;
                    }
                }
            }
            
            function select_click(id){            
                if (document.getElementById(id).checked) {
                    document.getElementById(id).checked = false;
                }else{
                    document.getElementById(id).checked = true;
                }
            }

            is_training = true;
            $( document ).ready(function() {
                $('li a.active').removeClass('active');
                $('a[href="' + location.pathname + '"]').closest('li a').addClass('active');

                check_train();
                var t1 = window.setInterval(()=>{
                    is_training = check_train();
                    if(is_training==false){
                        clearInterval(t1);
                    }                    
                }, 1000);
            });
            
            function check_train(){               
                    $.ajax({
                        type:'POST',
                        url:'{{url_for("trainTask_post")}}',
                        success:function(data){
                            if(data=="0"){
                                $('#train_nav').hide();
                                is_training = false;
                            }
                            else if(data=="1"){
                                $('#train_nav').show();
                                is_training = true;
                            }
                        },
                    });
                    return is_training
                }

            function cal_checkbox_select(select_ID, select_name, select_PID){
                var len = {{tree|length}};
                {%- for item in tree %}
                    if ("{{ item.ID }}" != ""){                       
                        if (document.getElementById("{{ item.ID }}").checked){
                            select_ID.push("{{ item.ID }}");
                            select_name.push("{{ item.RunTime }}");
                            select_PID.push("{{ item.PID }}");
                        }
                    }
                {% endfor %}
            }

            function del_port(){
                select_ID = [];
                select_name = [];
                select_PID = [];
                cal_checkbox_select(select_ID, select_name, select_PID);
                var answer = confirm("Make sure you want to delete it or them!");
                console.log(answer)
                $.ajax({
                    type:'POST',
                    url:'{{url_for("dataset_del_post")}}',
                    data:JSON.stringify(select_name),
                    contentType: "application/json",
                    success:function(data){
                        window.location.href = "dataset";
                    }
                });
            }
        </script>
    </body>
   
</html>